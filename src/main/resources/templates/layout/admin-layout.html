<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${pageTitle != null} ? ${pageTitle} + ' - Blackdot EMS' : 'Blackdot EMS'">Blackdot EMS</title>
    <link rel="stylesheet" th:href="@{/css/dashboard.css}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Header Fragment -->
    <header class="header" th:fragment="header">
        <div class="user-info">
            <h1><i class="fas fa-building"></i> Blackdot Portal</h1>
            <div class="user-name" th:if="${user}">
                <i class="fas fa-user"></i> 
                <span th:text="${user.firstName + ' ' + user.lastName}">User Name</span>
                <a href="#" onclick="logout()" class="btn btn-sm" style="margin-left: 1rem;">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </div>
        </div>
    </header>

    <!-- Sidebar Navigation Fragment -->
    <nav class="sidebar" th:fragment="sidebar(activePage)">
        <ul class="nav-menu">
            <li class="nav-item">
                <a th:href="@{/dashboard}" class="nav-link" th:classappend="${activePage == 'dashboard'} ? 'active' : ''">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </a>
            </li>
            <li class="nav-item">
                <a th:href="@{/dashboard/employees}" class="nav-link" th:classappend="${activePage == 'employees'} ? 'active' : ''">
                    <i class="fas fa-users"></i> Employees
                </a>
            </li>
            <li class="nav-item">
                <a th:href="@{/dashboard/departments}" class="nav-link" th:classappend="${activePage == 'departments'} ? 'active' : ''">
                    <i class="fas fa-sitemap"></i> Departments
                </a>
            </li>
            <li class="nav-item">
                <a th:href="@{/dashboard/roles}" class="nav-link" th:classappend="${activePage == 'roles'} ? 'active' : ''">
                    <i class="fas fa-user-shield"></i> Roles
                </a>
            </li>
            <li class="nav-item">
                <a th:href="@{/dashboard/assessments}" class="nav-link" th:classappend="${activePage == 'assessments'} ? 'active' : ''">
                    <i class="fas fa-clipboard-list"></i> Assessments
                </a>
            </li>
            <li class="nav-item">
                <a th:href="@{/dashboard/tasks}" class="nav-link" th:classappend="${activePage == 'tasks'} ? 'active' : ''">
                    <i class="fas fa-tasks"></i> Tasks
                </a>
            </li>
            <li class="nav-item">
                <a th:href="@{/dashboard/audit}" class="nav-link" th:classappend="${activePage == 'audit'} ? 'active' : ''">
                    <i class="fas fa-history"></i> Audit Trail
                </a>
            </li>
            <li class="nav-item">
                <a th:href="@{/dashboard/lifecycle}" class="nav-link" th:classappend="${activePage == 'lifecycle'} ? 'active' : ''">
                    <i class="fas fa-diagram-project"></i> Lifecycle
                </a>
            </li>
            <li class="nav-item">
                <a th:href="@{/dashboard/reports}" class="nav-link" th:classappend="${activePage == 'reports'} ? 'active' : ''">
                    <i class="fas fa-chart-bar"></i> Reports
                </a>
            </li>
        </ul>
    </nav>

    <!-- Common Scripts Fragment -->
    <th:block th:fragment="common-scripts">
        <script>
            // Get JWT token from localStorage
            function getToken() {
                return localStorage.getItem('jwtToken');
            }

            // Logout function
            function logout() {
                localStorage.removeItem('jwtToken');
                window.location.href = '/login';
            }
        </script>
    </th:block>
</body>
</html>
